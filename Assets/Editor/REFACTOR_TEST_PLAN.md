# Чек-лист: проверка рефакторинга (расширяемость)

После правок из `REFACTOR_EXTENSIBILITY.md` (EffectId, слоты, пути, версия сейва, GetSkill, комментарии) — пройти по пунктам ниже и убедиться, что ничего не сломалось.

---

## 1. Сборка и редактор

- [ ] **Unity**: открыть проект, дождаться компиляции. В консоли нет ошибок.
- [ ] **Меню редактора**: есть пункты **Tools → Crafting Orb Editor**, **Tools → Stats Editor**, **Tools → Items Editor** (или как у тебя названы). Окна открываются без ошибок.

---

## 2. EffectId орб (r1)

- [ ] **Crafting Orb Editor**: Tools → Crafting Orb Editor. Список орб подгружается; при создании новой орбы у неё `EffectId = "reroll_rare"` (или константа `CraftingOrbEffectId.RerollRare`).
- [ ] **Игра**: зайти в сцену с инвентарём. Положить редкий предмет в слот крафта, использовать орбу реролла — реролл срабатывает (логика не изменилась, проверяем только что код по EffectId не падает).

---

## 3. Слоты экипировки и UXML (r2)

- [ ] **Инвентарь в игре**: открыть инвентарь (I или кнопка). Отображаются 6 слотов экипировки: Helmet, Body, MainHand, OffHand, Gloves, Boots — в правильном порядке и с правильными иконками/подписями.
- [ ] **Перетаскивание**: надеть предмет в слот (например оружие в MainHand) и снять — всё реагирует корректно, без пустых слотов по визуалу.

---

## 4. Скиллы от экипировки (r3)

- [ ] **Оружие/предмет со скиллом**: надеть предмет, у которого в базе прописан скилл (например оружие с активным скиллом). Скилл появляется в слот скилла (обычно слот 0 для MainHand и т.д.), BodyArmor скиллов не даёт.
- [ ] **Снять предмет**: снять этот предмет — скилл пропадает из слота. Ошибок в консоли нет.

---

## 5. Централизованные пути (r4)

Проверяем, что все загрузки по путям из `ProjectPaths` / `EditorPaths` работают.

- [ ] **Инвентарь (runtime)**  
  - Открыть сцену с игроком и инвентарём.  
  - Открыть инвентарь — конфиг орб (`CraftingOrbSlotsConfig`) и слоты подгружаются, крафт/орбы отображаются без ошибок.

- [ ] **Окно персонажа (runtime)**  
  - Открыть окно статов/персонажа (C или как назначено).  
  - Статы подгружаются из `StatsDatabase` (Resources), список и значения отображаются.

- [ ] **Debug Inventory (если есть сцена/префаб)**  
  - Открыть сцену с Debug Inventory Window.  
  - Список предметов и орб подгружается из `ItemDatabase` и `CraftingOrbs`; создание тестового предмета/добавление орб работает.

- [ ] **Crafting Orb Editor**  
  - Tools → Crafting Orb Editor.  
  - Список орб из `Assets/Resources/CraftingOrbs`, конфиг слотов и MenuLabels подгружаются; создание новой орбы сохраняется в папку орб.

- [ ] **Stats Editor**  
  - Tools → Stats Editor.  
  - Подтягиваются MenuLabels и Stats Database (из `EditorPaths`/Resources); список статов, метаданные, локали отображаются.  
  - Кнопка «Create new Stats Database in Resources/Databases» создаёт базу по пути из `EditorPaths.StatsDatabase`.

- [ ] **Items Editor**  
  - Tools → Items Editor.  
  - Item Database подгружается (из `EditorPaths.ItemDatabase`), списки предметов/аффиксов/пулов отображаются.

---

## 6. Версия сейва и миграции (r5)

- [ ] **Новый сейв**  
  - Играть, сохранить (K). Открыть файл сейва (F12 — папка сохранений). В JSON есть поле `"SaveVersion": 1`.

- [ ] **Загрузка нового сейва**  
  - Загрузить игру (L). Персонаж, инвентарь, пассивки загружаются без ошибок.

- [ ] **Миграция старого сейва (без SaveVersion)**  
  - Вручную отредактировать `savegame.json`: удалить поле `SaveVersion` или задать `"SaveVersion": 0`.  
  - Запустить игру, нажать Load (L). В консоли сообщение о миграции (например «Save migrated: 0 -> 1»). Игра загружается без падений.

---

## 7. ItemDatabase GetSkill и комментарий (r6)

- [ ] **GetSkill warning**  
  - Ситуация, когда в сейве/данных указан ID скилла, которого нет в `ItemDatabase` (например временно переименовать/удалить скилл из базы или подставить несуществующий ID в тестовых данных). При загрузке инвентаря в консоли должно появиться предупреждение вида: `[ItemDatabase] Скилл с ID '...' не найден в базе!` — без краша.

- [ ] **InventorySaveData**  
  - Только документация: в коде `ItemSaveData.SlotIndex` есть Tooltip про `EQUIP_OFFSET` и `CRAFT_SLOT_INDEX`. Поведение сохранения/загрузки не менялось — достаточно убедиться, что сохранение и загрузка инвентаря по-прежнему работают (п. 6).

---

## 8. Итог

- [ ] Все пункты выше отмечены. Консоль без неожиданных ошибок после типичных действий (открытие окон, сохранение/загрузка, экипировка, скиллы, редакторы).

Если что-то падает — проверить: не менялись ли пути папок (Resources, Localization, Databases); что в сцене назначены ссылки на базы/префабы, где они требуются.
